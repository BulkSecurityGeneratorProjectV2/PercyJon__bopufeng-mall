<!DOCTYPE html>
<html style="height: 100%">
<head>
    <meta charset="utf-8">
</head>
<body style="height: 100%; margin: 0">
	<div style="width:800px; height:495px;float:right;" >
		<div id="container" style="height: 100%"></div>
	</div>
	<script src="echarts.min.js"></script>
	<script src="../jQuery/jquery-2.2.3.min.js"></script>
	<script type="text/javascript">
     
        var dataChina = [
    		{
	            name: "南海诸岛",
	            value: 0
	        },
	        {
	            name: '北京市',
	            value: 154
	        },
	        {
	            name: '天津市',
	            value: 13
	        },
	        {
	            name: '上海市',
	            value: 40
	        },
	        {
	            name: '重庆市',
	            value: 75
	        },
	        {
	            name: '河北省',
	            value: 13
	        },
	        {
	            name: '河南省',
	            value: 83
	        },
	        {
	            name: '云南省',
	            value: 11
	        },
	        {
	            name: '辽宁省',
	            value: 19
	        },
	        {
	            name: '黑龙江省',
	            value: 15
	        },
	        {
	            name: '湖南省',
	            value: 69
	        },
	        {
	            name: '安徽省',
	            value: 60
	        },
	        {
	            name: '山东省',
	            value: 39
	        },
	        {
	            name: '新疆维吾尔自治区',
	            value: 4
	        },
	        {
	            name: '江苏省',
	            value: 31
	        },
	        {
	            name: '浙江省',
	            value: 104
	        },
	        {
	            name: '江西省',
	            value: 36
	        },
	        {
	            name: '湖北省',
	            value: 1052
	        },
	        {
	            name: '广西壮族自治区',
	            value: 33
	        },
	        {
	            name: '甘肃省',
	            value: 7
	        },
	        {
	            name: '山西省',
	            value: 9
	        },
	        {
	            name: '内蒙古自治区',
	            value: 7
	        },
	        {
	            name: '陕西省',
	            value: 22
	        },
	        {
	            name: '吉林省',
	            value: 4
	        },
	        {
	            name: '福建省',
	            value: 18
	        },
	        {
	            name: '贵州省',
	            value: 5
	        },
	        {
	            name: '广东省',
	            value: 98
	        },
	        {
	            name: '青海省',
	            value: 1
	        },
	        {
	            name: '西藏自治区',
	            value: 0
	        },
	        {
	            name: '四川省',
	            value: 44
	        },
	        {
	            name: '宁夏回族自治区',
	            value: 4
	        },
	        {
	            name: '海南省',
	            value: 22
	        },
	        {
	            name: '台湾省',
	            value: 3
	        },
	        {
	            name: '香港特别行政区',
	            value: 5
	        },
	        {
	            name: '澳门特别行政区',
	            value: 5
	        }
	    ];
        
        var dataBeijing = [
	    	{
				"name": "丰台区",
				"value": 23,
			}, {
				"name": "大兴区",
				"value": 34,
			}, {
				"name": "东城区",
				"value": 11,
			}, {
				"name": "通州区",
				"value": 8,
				"uvValue": 0
			}, {
				"name": "海淀区",
				"value": 9,
			}, {
				"name": "平谷区",
				"value": 23,
			}, {
				"name": "朝阳区",
				"value": 44,
			}, {
				"name": "昌平区",
				"value": 56,
			}, {
				"name": "房山区",
				"value": 55,
			}, {
				"name": "延庆区",
				"value": 78,
			}, {
				"name": "石景山区",
				"value": 100,
			}, {
				"name": "怀柔区",
				"value": 298,
			}, {
				"name": "西城区",
				"value": 222,
				"uvValue": 0
			}, {
				"name": "顺义区",
				"value": 345,
			}, {
				"name": "门头沟区",
				"value": 1322,
			}, {
				"name": "密云区",
				"value": 25,
			}
	    ];
        
        var allAreaJsonMap = {
       		'china': 'china',
			'安徽省': 'anhui',
			'澳门特别行政区': 'aomen',
			'北京市': 'beijing',
			'重庆市': 'chongqing',
			'福建省': 'fujian',
			'甘肃省': 'gansu',
			'广东省': 'guangdong',
			'广西壮族自治区': 'guangxi',
			'贵州省': 'guizhou',
			'海南省': 'hainan',
			'河北省': 'hebei',
			'黑龙江省': 'heilongjiang',
			'河南省': 'henan',
			'湖北省': 'hubei',
			'湖南省': 'hunan',
			'江苏省': 'jiangsu',
			'江西省': 'jiangxi',
			'吉林省': 'jilin',
			'辽宁省': 'liaoning',
			'内蒙古自治区': 'neimenggu',
			'宁夏回族自治区': 'ningxia',
			'青海省': 'qinghai',
			'山东省': 'shandong',
			'上海市': 'shanghai',
			'山西省': 'shanxi',
			'陕西省': 'shanxi1',
			'四川省': 'sichuan',
			'台湾省': 'taiwan',
			'天津市': 'tianjin',
			'香港特别行政区': 'xianggang',
			'新疆维吾尔自治区': 'xinjiang',
			'西藏自治区': 'xizang',
			'云南省': 'yunnan',
			'浙江省': 'zhejiang',
        };
        
        initChart();
        
        async function initChart() {
            let chart = echarts.init(document.getElementById("container"));
            let chinaGeoJson = await getGeoJson('china.json');
            initEcharts(chinaGeoJson, 'china', chart, allAreaJsonMap, dataChina);
        }
        
        function initEcharts(areaGeoJson, name, chart, allAreaJsonMap, dataOption) {
        	echarts.registerMap(name, areaGeoJson);
        	let option = {
                title: {
                    text: name,
                    left: 'center',
                },
                tooltip: {
                    trigger: 'item',
                    formatter: '{b}<br/>{c} (人)'
                },
                visualMap: {
                	min: 0,
                    max: 1000,
                    left: 26,
                    bottom: 40,
                    showLabel: !0,
                    text: ["高", "低"],
                    pieces: [{
                        gt: 1000,
                        label: ">= 1000 人",
                        color: "lightskyblue"
                    }, {
                        gte: 100,
                        lte: 999,
                        label: "100 - 999 人",
                        color: "#67ce5f"
                    }, {
                        gte: 1,
                        lt: 99,
                        label: "1 - 99 人",
                        color: "#c7e0bd"
                    }, {
                        value: 0,
                        color: "#ffffff"
                    }],
                    show: !0
                },
                series: [
	   				{
	   				    type: 'map',
	   				 	map: name,
	   				    label: {
	   				        show: false
	   				    },
	   				    data: dataOption
	   				}
    			]
            };
        	chart.setOption(option);
        	chart.off("click");
        	chart.on("click", params => {
        		let isProvice = false;
        		let clickRegion;
                for (let index in allAreaJsonMap) {
                  if(params.name == index) {
                    isProvice = true;
                    clickRegion = allAreaJsonMap[index];
                  }
                };
                console.log("点击的地方", clickRegion);
                // 渲染省份数据
                if(isProvice) {
                	getGeoJson(clickRegion + '.json').then(regionGeoJson => {
        				initEcharts(regionGeoJson, params.name, chart, allAreaJsonMap, dataBeijing);
        			}).catch(err => {
        				initEcharts(chinaGeoJson, 'china', chart, allAreaJsonMap, dataChina);
        			});
                }
        	});
        }
        
        async function getGeoJson(jsonName) {
        	return await $.get('/plugins/echarts/json/' + jsonName, "json");
        }
        
	</script>
</body>
</html>
    